---
title: "Organic Food Environment Assessment"
author: "Alexandra Sadler"
date: "19/07/2024"
output: word_document
---

```{r setup, include=FALSE}
# Load necessary libraries
library(dplyr)
library(gmodels)
library(gt)
library(knitr)
library(kableExtra)
library(openxlsx)
library(readxl)
library(readr)
library(stats)
library(tidyr)

knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}

# Load cleaned data
data_clean <- read_excel("C:/Users/s1985751/OneDrive - University of Edinburgh/Food Environment Assessment/Data analysis/R/combined_data.xlsx")

```

## Descriptive Results

```{r echo = FALSE, message = FALSE, warning = FALSE}
# Generate Table 1

# Calculate total vendors per city
overall_data <- data_clean %>%
  group_by(country, city) %>%
  summarise(total_vendors = n()) %>%
  ungroup()

# Calculate neighbourhood counts and percentages
neighbourhood_data <- data_clean %>%
  group_by(country, city, circle) %>%
  summarise(count = n()) %>%
  pivot_wider(names_from = circle, values_from = count, values_fill = list(count = 0)) %>%
  ungroup() %>%
  left_join(overall_data, by = c("country", "city")) %>%
  mutate(
    higher_perc = Higher / total_vendors,
    middle_perc = Middle / total_vendors,
    lower_perc = Lower / total_vendors
  ) %>%
  select(country, city, total_vendors, Higher, higher_perc, Middle, middle_perc, Lower, lower_perc)

# Calculate store type counts and percentages
store_data <- data_clean %>%
  group_by(country, city, vendor_type) %>%
  summarise(count = n()) %>%
  pivot_wider(names_from = vendor_type, values_from = count, values_fill = list(count = 0)) %>%
  ungroup() %>%
  left_join(overall_data, by = c("country", "city")) %>%
  mutate(
    supermarket_perc = Supermarket / total_vendors,
    mobile_vendor_perc = `Mobile vendor` / total_vendors,
    stationary_small_vendor_perc = `Stationary small local vendor` / total_vendors
  ) %>%
  select(country, city, `Mobile vendor`, mobile_vendor_perc, `Stationary small local vendor`, stationary_small_vendor_perc, Supermarket, supermarket_perc,  )


# Merge both datasets
tab1_data <- neighbourhood_data %>%
  left_join(store_data, by = c("country", "city"))


# Create the gt table
tab1 <- tab1_data %>%
  gt(rowname_col = "city", groupname_col = "country") %>%
  cols_label(
    city = "City",
    total_vendors = "Total vendors",
    Higher = "Higher",
    higher_perc = " ",
    Middle = "Middle",
    middle_perc = " ",
    Lower = "Lower",
    lower_perc = " ",
    `Mobile vendor` = "Mobile vendor",
    mobile_vendor_perc = " ",
    `Stationary small local vendor` = "Stationary small vendor",
    stationary_small_vendor_perc = " ",
    Supermarket = "Supermarket",
    supermarket_perc = " "
  ) %>%
  fmt_percent(
    columns = vars(higher_perc, middle_perc, lower_perc,
                   mobile_vendor_perc, stationary_small_vendor_perc,
                   supermarket_perc),
    decimals = 0
  ) %>%
  cols_merge(
    columns = c("Higher", "higher_perc"),
    pattern = "{1} ({2})"
  ) %>%
  cols_merge(
    columns = c("Middle", "middle_perc"),
    pattern = "{1} ({2})"
  ) %>%
  cols_merge(
    columns = c("Lower", "lower_perc"),
    pattern = "{1} ({2})"
  ) %>%
  cols_merge(
    columns = c("Mobile vendor", "mobile_vendor_perc"),
    pattern = "{1} ({2})"
  ) %>%
  cols_merge(
    columns = c("Stationary small local vendor",
                "stationary_small_vendor_perc"),
    pattern = "{1} ({2})"
  ) %>%
  cols_merge(
    columns = c("Supermarket", "supermarket_perc"),
    pattern = "{1} ({2})"
  ) #%>%
#  summary_rows(
#    groups = TRUE,
#    columns = vars(total_vendors, Higher, higher_perc,
#                   Middle, middle_perc,
#                   Lower, lower_perc, 
#                   `Mobile vendor`, mobile_vendor_perc,
#                   `Stationary small local vendor`,
#                   stationary_small_vendor_perc,
#                   Supermarket, supermarket_perc),
#    fns = list(Total = ~sum(.x, na.rm = TRUE)),
#    formatter = fmt_number,
#    decimals = 0
#  )
  
# Display the table
tab1



```



## 1. What is the availability of organic food in urban food environments? How does this vary across different geographic and socioeconomic contexts?

### Hypothesis 1a. Organic food availability will be highest in the United Kingdom, in larger cities within a given country, and in higher-income neighbourhoods within a given city.

#### Kruskal-Wallis rank sum test

##### Overall results (variation between countries)
```{r echo = FALSE, message = FALSE, warning = FALSE}

# Create data frame of country and org_foods_count
kruskal_country_data <- data_clean %>%
  select(country, org_foods_count)

# Perform the Kruskal-Wallis test
result_overall <- kruskal.test(org_foods_count ~ country, data = kruskal_country_data)
  
# Display the results
print(result_overall)

```

##### Country-level results (variation between cities within a given country)

###### Brazil

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Create data frame for Brazil
brazil <- data_clean %>%
  filter(country == "Brazil")

# Create data frame of city and org_foods_count
kruskal_brazil_city_data <- brazil %>%
  select(city, org_foods_count)

# Perform the Kruskal-Wallis test
result_brazil <- kruskal.test(org_foods_count ~ city, data = kruskal_brazil_city_data)
  
# Display the results
print(result_brazil)

```

###### India

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Create data frame for India
india <- data_clean %>%
  filter(country == "India")

# Create data frame of city and org_foods_count
kruskal_india_city_data <- india %>%
  select(city, org_foods_count)

# Perform the Kruskal-Wallis test
result_india <- kruskal.test(org_foods_count ~ city, data = kruskal_india_city_data)
  
# Display the results
print(result_india)

```

###### United Kingdom

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Create data frame for India
uk <- data_clean %>%
  filter(country == "UK")

# Create data frame of city and org_foods_count
kruskal_uk_city_data <- uk %>%
  select(city, org_foods_count)

# Perform the Kruskal-Wallis test
result_uk <- kruskal.test(org_foods_count ~ city, data = kruskal_uk_city_data)
  
# Display the results
print(result_uk)

```

##### Neighbourhood-level results (variation between neighbourhoods within a given city)

###### Brazil: Rio de Janeiro

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Create data frame for Rio de Janeiro
rio <- data_clean %>%
  filter(city == "Rio de Janeiro")

# Create data frame of circle and org_foods_count
kruskal_rio_data <- rio %>%
  select(circle, org_foods_count)

# Perform the Kruskal-Wallis test
result_rio <- kruskal.test(org_foods_count ~ circle, data = kruskal_rio_data)
  
# Display the results
print(result_rio)

```

###### Brazil: Sao Paulo

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Create data frame for Sao Paulo
saopaulo <- data_clean %>%
  filter(city == "Sao Paolo")

# Create data frame of circle and org_foods_count
kruskal_saopaulo_data <- saopaulo %>%
  select(circle, org_foods_count)

# Perform the Kruskal-Wallis test
result_saopaulo <- kruskal.test(org_foods_count ~ circle, data = kruskal_saopaulo_data)
  
# Display the results
print(result_saopaulo)

```

###### Brazil: Sinop

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Create data frame for Sinop
sinop <- data_clean %>%
  filter(city == "Sinop")

# Create data frame of circle and org_foods_count
kruskal_sinop_data <- sinop %>%
  select(circle, org_foods_count)

# Perform the Kruskal-Wallis test
result_sinop <- kruskal.test(org_foods_count ~ circle, data = kruskal_sinop_data)
  
# Display the results
print(result_sinop)

```


###### India: Hyderabad

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Create data frame for Hyderabad
hyderabad <- data_clean %>%
  filter(city == "Hyderabad")

# Create data frame of circle and org_foods_count
kruskal_hyderabad_data <- hyderabad %>%
  select(circle, org_foods_count)

# Perform the Kruskal-Wallis test
result_hyderabad <- kruskal.test(org_foods_count ~ circle, data = kruskal_hyderabad_data)
  
# Display the results
print(result_hyderabad)

```

###### India: Latur

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Create data frame for Latur
latur <- data_clean %>%
  filter(city == "Latur")

# Create data frame of circle and org_foods_count
kruskal_latur_data <- latur %>%
  select(circle, org_foods_count)

# Perform the Kruskal-Wallis test
result_latur <- kruskal.test(org_foods_count ~ circle, data = kruskal_latur_data)
  
# Display the results
print(result_latur)

```

###### India: Visakhapatnam

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Create data frame for Visakhapatnam
visakhapatnam <- data_clean %>%
  filter(city == "Visakhapatnam")

# Create data frame of circle and org_foods_count
kruskal_visakhapatnam_data <- visakhapatnam %>%
  select(circle, org_foods_count)

# Perform the Kruskal-Wallis test
result_visakhapatnam <- kruskal.test(org_foods_count ~ circle, data = kruskal_visakhapatnam_data)
  
# Display the results
print(result_visakhapatnam)

```

###### United Kingdom: Birmingham

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Create data frame for Birmingham
birmingham <- data_clean %>%
  filter(city == "Birmingham")

# Create data frame of circle and org_foods_count
kruskal_birmingham_data <- birmingham %>%
  select(circle, org_foods_count)

# Perform the Kruskal-Wallis test
result_birmingham <- kruskal.test(org_foods_count ~ circle, data = kruskal_birmingham_data)
  
# Display the results
print(result_birmingham)

```

###### UK: Edinburgh

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Create data frame for Edinburgh
edinburgh <- data_clean %>%
  filter(city == "Edinburgh")

# Create data frame of circle and org_foods_count
kruskal_edinburgh_data <- edinburgh %>%
  select(circle, org_foods_count)

# Perform the Kruskal-Wallis test
result_edinburgh <- kruskal.test(org_foods_count ~ circle, data = kruskal_edinburgh_data)
  
# Display the results
print(result_edinburgh)

```

###### UK: London

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Create data frame for London
london <- data_clean %>%
  filter(city == "London")

# Create data frame of circle and org_foods_count
kruskal_london_data <- london %>%
  select(circle, org_foods_count)

# Perform the Kruskal-Wallis test
result_london <- kruskal.test(org_foods_count ~ circle, data = kruskal_london_data)
  
# Display the results
print(result_london)

```

#### Chi-squared test

##### Overall results (variation between countries)
```{r echo = FALSE, message = FALSE, warning = FALSE}
# Prepare a contingency table
contingency_table <- data_clean %>%
  group_by(country, org_vendor) %>%
  tally() %>%
  pivot_wider(names_from = org_vendor, values_from = n, values_fill = list(n = 0))

# Convert to matrix 
data_matrix <- as.matrix(contingency_table[, -1])

# Set row names
rownames(data_matrix) <- contingency_table$country

# Display the matrix to check if it's correct
print(data_matrix)

# Perform Chi-squared test
chi_result_overall <- chisq.test(data_matrix)

# Display the results
print(chi_result_overall)

```

##### Country-level results (variation between cities within a given country)

###### Brazil

```{r echo = FALSE, message = FALSE, warning = FALSE}
# Prepare a contingency table
contingency_table <- brazil %>%
  group_by(city, org_vendor) %>%
  tally() %>%
  pivot_wider(names_from = org_vendor, values_from = n, values_fill = list(n = 0))

# Convert to matrix 
data_matrix <- as.matrix(contingency_table[, -1])

# Set row names
rownames(data_matrix) <- contingency_table$city

# Display the matrix to check if it's correct
print(data_matrix)

# Perform Chi-squared test
chi_result_brazil <- chisq.test(data_matrix)

# Display the results
print(chi_result_brazil)

```

###### India

```{r echo = FALSE, message = FALSE, warning = FALSE}
# Prepare a contingency table
contingency_table <- india %>%
  group_by(city, org_vendor) %>%
  tally() %>%
  pivot_wider(names_from = org_vendor, values_from = n, values_fill = list(n = 0))

# Convert to matrix 
data_matrix <- as.matrix(contingency_table[, -1])

# Set row names
rownames(data_matrix) <- contingency_table$city

# Display the matrix to check if it's correct
print(data_matrix)

# Perform Chi-squared test
chi_result_india <- chisq.test(data_matrix)

# Display the results
print(chi_result_india)
```

###### United Kingdom

```{r echo = FALSE, message = FALSE, warning = FALSE}
# Prepare a contingency table
contingency_table <- uk %>%
  group_by(city, org_vendor) %>%
  tally() %>%
  pivot_wider(names_from = org_vendor, values_from = n, values_fill = list(n = 0))

# Convert to matrix 
data_matrix <- as.matrix(contingency_table[, -1])

# Set row names
rownames(data_matrix) <- contingency_table$city

# Display the matrix to check if it's correct
print(data_matrix)

# Perform Chi-squared test
chi_result_uk <- chisq.test(data_matrix)

# Display the results
print(chi_result_uk)
```

##### Neighbourhood-level results (variation between neighbourhoods within a given city)

###### Brazil: Rio de Janeiro

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Prepare a contingency table
contingency_table <- rio %>%
  group_by(circle, org_vendor) %>%
  tally() %>%
  pivot_wider(names_from = org_vendor, values_from = n, values_fill = list(n = 0))

# Convert to matrix 
data_matrix <- as.matrix(contingency_table[, -1])

# Set row names
rownames(data_matrix) <- contingency_table$circle

# Display the matrix to check if it's correct
print(data_matrix)

# Perform Chi-squared test
chi_result_rio <- chisq.test(data_matrix)

# Display the results
print(chi_result_rio)

```


###### Brazil: Sao Paulo

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Prepare a contingency table
contingency_table <- saopaulo %>%
  group_by(circle, org_vendor) %>%
  tally() %>%
  pivot_wider(names_from = org_vendor, values_from = n, values_fill = list(n = 0))

# Convert to matrix 
data_matrix <- as.matrix(contingency_table[, -1])

# Set row names
rownames(data_matrix) <- contingency_table$circle

# Display the matrix to check if it's correct
print(data_matrix)

# Perform Chi-squared test
chi_result_saopaulo <- chisq.test(data_matrix)

# Display the results
print(chi_result_saopaulo)

```

###### Brazil: Sinop

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Prepare a contingency table
contingency_table <- sinop %>%
  group_by(circle, org_vendor) %>%
  tally() %>%
  pivot_wider(names_from = org_vendor, values_from = n, values_fill = list(n = 0))

# Convert to matrix 
data_matrix <- as.matrix(contingency_table[, -1])

# Set row names
rownames(data_matrix) <- contingency_table$circle

# Display the matrix to check if it's correct
print(data_matrix)

# Perform Chi-squared test
chi_result_sinop <- chisq.test(data_matrix)

# Display the results
print(chi_result_sinop)

```

###### India: Hyderabad

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Prepare a contingency table
contingency_table <- hyderabad %>%
  group_by(circle, org_vendor) %>%
  tally() %>%
  pivot_wider(names_from = org_vendor, values_from = n, values_fill = list(n = 0))

# Convert to matrix 
data_matrix <- as.matrix(contingency_table[, -1])

# Set row names
rownames(data_matrix) <- contingency_table$circle

# Display the matrix to check if it's correct
print(data_matrix)

# Perform Chi-squared test
chi_result_hyderabad <- chisq.test(data_matrix)

# Display the results
print(chi_result_hyderabad)

```

###### India: Latur

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Prepare a contingency table
contingency_table <- latur %>%
  group_by(circle, org_vendor) %>%
  tally() %>%
  pivot_wider(names_from = org_vendor, values_from = n, values_fill = list(n = 0))

# Convert to matrix 
data_matrix <- as.matrix(contingency_table[, -1])

# Set row names
rownames(data_matrix) <- contingency_table$circle

# Display the matrix to check if it's correct
print(data_matrix)

# Perform Chi-squared test
chi_result_latur <- chisq.test(data_matrix)

# Display the results
print(chi_result_latur)

```

###### India: Visakhapatnam

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Prepare a contingency table
contingency_table <- visakhapatnam %>%
  group_by(circle, org_vendor) %>%
  tally() %>%
  pivot_wider(names_from = org_vendor, values_from = n, values_fill = list(n = 0))

# Convert to matrix 
data_matrix <- as.matrix(contingency_table[, -1])

# Set row names
rownames(data_matrix) <- contingency_table$circle

# Display the matrix to check if it's correct
print(data_matrix)

# Perform Chi-squared test
chi_result_latur <- chisq.test(data_matrix)

# Display the results
print(chi_result_latur)
```

###### United Kingdom: Birmingham

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Prepare a contingency table
contingency_table <- birmingham %>%
  group_by(circle, org_vendor) %>%
  tally() %>%
  pivot_wider(names_from = org_vendor, values_from = n, values_fill = list(n = 0))

# Convert to matrix 
data_matrix <- as.matrix(contingency_table[, -1])

# Set row names
rownames(data_matrix) <- contingency_table$circle

# Display the matrix to check if it's correct
print(data_matrix)

# Perform Chi-squared test
chi_result_birmingham <- chisq.test(data_matrix)

# Display the results
print(chi_result_birmingham)

```

###### United Kingdom: Edinburgh

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Prepare a contingency table
contingency_table <- edinburgh %>%
  group_by(circle, org_vendor) %>%
  tally() %>%
  pivot_wider(names_from = org_vendor, values_from = n, values_fill = list(n = 0))

# Convert to matrix 
data_matrix <- as.matrix(contingency_table[, -1])

# Set row names
rownames(data_matrix) <- contingency_table$circle

# Display the matrix to check if it's correct
print(data_matrix)

# Perform Chi-squared test
chi_result_edinburgh <- chisq.test(data_matrix)

# Display the results
print(chi_result_edinburgh)

```

###### United Kingdom: London

```{r echo = FALSE, message = FALSE, warning = FALSE}

# Prepare a contingency table
contingency_table <- london %>%
  group_by(circle, org_vendor) %>%
  tally() %>%
  pivot_wider(names_from = org_vendor, values_from = n, values_fill = list(n = 0))

# Convert to matrix 
data_matrix <- as.matrix(contingency_table[, -1])

# Set row names
rownames(data_matrix) <- contingency_table$circle

# Display the matrix to check if it's correct
print(data_matrix)

# Perform Chi-squared test
chi_result_london <- chisq.test(data_matrix)

# Display the results
print(chi_result_london)

```


#### Median and interquartile range

##### For each neighbourhood within each city
```{r echo = FALSE, message = FALSE, warning = FALSE}
# Median and IQR for each neighborhood within each city
neighborhood_stats <- data_clean %>%
  group_by(country, city, circle) %>%
  summarize(
    median_org_foods_count = median(org_foods_count, na.rm = TRUE),
    iqr_org_foods_count = IQR(org_foods_count, na.rm = TRUE)
  ) %>%
  ungroup()

print(neighborhood_stats)
```

##### For each city within each country
```{r echo = FALSE, message = FALSE, warning = FALSE}
# Median and IQR for each city within each country
city_stats <- data_clean %>%
  group_by(country, city) %>%
  summarize(
    median_org_foods_count = median(org_foods_count, na.rm = TRUE),
    iqr_org_foods_count = IQR(org_foods_count, na.rm = TRUE)
  ) %>%
  ungroup()

print(city_stats)
```

##### For each country
```{r echo = FALSE, message = FALSE, warning = FALSE}
# Median and IQR for each country
country_stats <- data_clean %>%
  group_by(country) %>%
  summarize(
    median_org_foods_count = median(org_foods_count, na.rm = TRUE),
    iqr_org_foods_count = IQR(org_foods_count, na.rm = TRUE)
  ) %>%
  ungroup()

print(country_stats)
```

##### Overall
```{r echo = FALSE, message = FALSE, warning = FALSE}
# Calculate the overall median and IQR
overall_median <- median(data_clean$org_foods_count, na.rm = TRUE)
overall_iqr <- IQR(data_clean$org_foods_count, na.rm = TRUE)

# Display the results
overall_median
overall_iqr
```


### Exploratory Analysis: Hypothesis 1b. The count and proportion of vendors selling multiple organic options for at least one sentinel food will be highest in the United Kingdom, in larger cities within a given country, and in higher-income neighbourhoods within a given city.


#### Median and interquartile range

##### For each neighbourhood within each city
```{r echo = FALSE, message = FALSE, warning = FALSE}
# Median and IQR for each neighborhood within each city
neighborhood_stats2 <- data_clean %>%
  group_by(country, city, circle) %>%
  summarize(
    median_multiple_org_count = median(multiple_org_count, na.rm = TRUE),
    iqr_multiple_org_count = IQR(multiple_org_count, na.rm = TRUE)
  ) %>%
  ungroup()

print(neighborhood_stats2)
```

##### For each city within each country
```{r echo = FALSE, message = FALSE, warning = FALSE}
# Median and IQR for each city within each country
city_stats2 <- data_clean %>%
  group_by(country, city) %>%
  summarize(
    median_multiple_org_count = median(multiple_org_count, na.rm = TRUE),
    iqr_multiple_org_count = IQR(multiple_org_count, na.rm = TRUE)
  ) %>%
  ungroup()

print(city_stats2)
```

##### For each country
```{r echo = FALSE, message = FALSE, warning = FALSE}
# Median and IQR for each country
country_stats2 <- data_clean %>%
  group_by(country) %>%
  summarize(
    median_multiple_org_count = median(multiple_org_count, na.rm = TRUE),
    iqr_multiple_org_count = IQR(multiple_org_count, na.rm = TRUE)
  ) %>%
  ungroup()

print(country_stats2)
```

##### Overall
```{r echo = FALSE, message = FALSE, warning = FALSE}
# Calculate the overall median and IQR
overall_median2 <- median(data_clean$multiple_org_count, na.rm = TRUE)
overall_iqr2 <- IQR(data_clean$multiple_org_count, na.rm = TRUE)

# Display the results
overall_median2
overall_iqr2
```

### Exploratory Analysis: Organic versus non-organic vendor characteristics

#### Country-level

```{r echo = FALSE, message = FALSE, warning = FALSE}
# Summarize the data grouped by `org_vendor` and `country`
country_summary_stats <- data_clean %>%
  group_by(country, org_vendor) %>%
  summarize(
    median_vendor_cashiers = median(vendor_cashiers, na.rm = TRUE),
    iqr_vendor_cashiers = IQR(vendor_cashiers, na.rm = TRUE),
    min_vendor_cashiers = min(vendor_cashiers, na.rm = TRUE),
    max_vendor_cashiers = max(vendor_cashiers, na.rm = TRUE),
    
    median_days_open_count = median(days_open_count, na.rm = TRUE),
    iqr_days_open_count = IQR(days_open_count, na.rm = TRUE),
    min_days_open_count = min(days_open_count, na.rm = TRUE),
    max_days_open_count = max(days_open_count, na.rm = TRUE),
    
    median_foods_count = median(foods_count, na.rm = TRUE),
    iqr_foods_count = IQR(foods_count, na.rm = TRUE),
    min_foods_count = min(foods_count, na.rm = TRUE),
    max_foods_count = max(foods_count, na.rm = TRUE)
  ) %>%
  ungroup()

# Display the country-level results
print(country_summary_stats)
```

#### Overall

```{r echo = FALSE, message = FALSE, warning = FALSE}
# Summarize the data for overall statistics grouped by `org_vendor`
overall_summary_stats <- data_clean %>%
  group_by(org_vendor) %>%
  summarize(
    median_vendor_cashiers = median(vendor_cashiers, na.rm = TRUE),
    iqr_vendor_cashiers = IQR(vendor_cashiers, na.rm = TRUE),
    min_vendor_cashiers = min(vendor_cashiers, na.rm = TRUE),
    max_vendor_cashiers = max(vendor_cashiers, na.rm = TRUE),
    
    median_days_open_count = median(days_open_count, na.rm = TRUE),
    iqr_days_open_count = IQR(days_open_count, na.rm = TRUE),
    min_days_open_count = min(days_open_count, na.rm = TRUE),
    max_days_open_count = max(days_open_count, na.rm = TRUE),
    
    median_foods_count = median(foods_count, na.rm = TRUE),
    iqr_foods_count = IQR(foods_count, na.rm = TRUE),
    min_foods_count = min(foods_count, na.rm = TRUE),
    max_foods_count = max(foods_count, na.rm = TRUE)
  ) %>%
  ungroup()

# Display the overall results
print(overall_summary_stats)
```


# Create tables



