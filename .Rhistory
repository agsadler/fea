# Create table in correct data format
tab5_boxplot <- tab5_city_data %>%
# Calculate Q1 and Q3
mutate(
q1_org_rice = median_org_rice - (iqr_org_rice / 2),
q3_org_rice = median_org_rice + (iqr_org_rice / 2),
q1_conv_rice = median_conv_rice - (iqr_conv_rice / 2),
q3_conv_rice = median_conv_rice + (iqr_conv_rice / 2),
) %>%
# Select necessary columns
select(
country, city,
min_org_rice, q1_org_rice, median_org_rice, q3_org_rice, max_org_rice,
min_conv_rice, q1_conv_rice, median_conv_rice, q3_conv_rice, max_conv_rice
) %>%
# Reshape into long format
pivot_longer(
cols = c(min_org_rice, q1_org_rice, median_org_rice, q3_org_rice, max_org_rice,
min_conv_rice, q1_conv_rice, median_conv_rice, q3_conv_rice, max_conv_rice), # Include all relevant columns
names_to = c(".value", "Type"),                # Separate names into '.value' (metrics) and 'Type'
names_pattern = "(.*)_(org|conv)"              # Pattern: metric_(org|conv)
)
# Create boxplot
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge2(padding = 0.2) # Dodge to avoid overlapping between cities
) +
facet_wrap(~ country, scales = "free_x") + # Separate panels by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(size = 12, face = "bold")
)
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge2(padding = 0.3) # Dodge to avoid overlapping between cities
) +
facet_wrap(~ country, scales = "free_x") + # Separate panels by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(size = 12, face = "bold")
)
# Create boxplot
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge2(padding = 0.3) # Dodge to avoid overlapping between cities
) +
facet_wrap(~ country, scales = "free_x") + # Separate panels by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), # Rotated x-axis labels
strip.text = element_text(size = 12, face = "bold"), # Facet titles
legend.position = "bottom", # Move legend to the bottom
)
# Create boxplot
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge2(padding = 0.3) # Dodge to avoid overlapping between cities
) +
facet_wrap(~ country, scales = "free_x") + # Separate panels by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), # Rotated x-axis labels
strip.text = element_text(size = 12, face = "bold"), # Facet titles
legend.position = "bottom", # Move legend to the bottom
legend.title = element_blank() # Remove legend title
)
# Create boxplot
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge2(padding = 0.3) # Dodge to avoid overlapping between cities
) +
facet_wrap(~ country, scales = "free_x") + # Separate panels by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
# theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), # Rotated x-axis labels
strip.text = element_text(size = 12, face = "bold"), # Facet titles
legend.position = "bottom", # Move legend to the bottom
legend.title = element_blank() # Remove legend title
)
# Create boxplot
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge2(padding = 0.3) # Dodge to avoid overlapping between cities
) +
facet_wrap(~ country, scales = "free_x") + # Separate panels by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_light() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), # Rotated x-axis labels
strip.text = element_text(size = 12, face = "bold"), # Facet titles
legend.position = "bottom", # Move legend to the bottom
legend.title = element_blank() # Remove legend title
)
# Create boxplot
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge2(padding = 0.3) # Dodge to avoid overlapping between cities
) +
facet_wrap(~ country, scales = "free_x") + # Separate panels by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_classic() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), # Rotated x-axis labels
strip.text = element_text(size = 12, face = "bold"), # Facet titles
legend.position = "bottom", # Move legend to the bottom
legend.title = element_blank() # Remove legend title
)
# Create boxplot
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge2(padding = 0.3) # Dodge to avoid overlapping between cities
) +
facet_wrap(~ country, scales = "free_x", space = "free") + # Separate panels by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), # Rotated x-axis labels
strip.text = element_text(size = 12, face = "bold"), # Facet titles
legend.position = "bottom", # Move legend to the bottom
legend.title = element_blank() # Remove legend title
)
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge(width = 0.8)
) +
facet_grid(~ country, scales = "free_x", space = "free") + # Group by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1), # Rotate city labels
strip.text.x = element_text(size = 12, face = "bold"),           # Style country labels
panel.spacing.x = unit(2, "lines"),                              # Add spacing between countries
legend.position = "bottom"                                       # Legend at the bottom
)
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge2(padding = 0.3) # Dodge to avoid overlapping between cities
) +
facet_wrap(~ country, scales = "free_x", space = "free") + # Separate panels by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), # Rotated x-axis labels
strip.text = element_text(size = 12, face = "bold"), # Facet titles
legend.position = "bottom", # Move legend to the bottom
legend.title = element_blank() # Remove legend title
)
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge2(padding = 0.3) # Dodge to avoid overlapping between cities
) +
facet_wrap(~ country, scales = "free_x") + # Separate panels by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_light() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), # Rotated x-axis labels
strip.text = element_text(size = 12, face = "bold"), # Facet titles
legend.position = "bottom", # Move legend to the bottom
legend.title = element_blank() # Remove legend title
)
# Create boxplot
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge2(padding = 0.3) # Dodge to avoid overlapping between cities
) +
facet_wrap(~ country, scales = "free_x") + # Separate panels by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), # Rotated x-axis labels
strip.text = element_text(size = 12, face = "bold"), # Facet titles
legend.position = "bottom", # Move legend to the bottom
legend.title = element_blank() # Remove legend title
)
ggplot(tab5_boxplot, aes(x = city_country_label, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge(width = 0.8) # Side-by-side box plots
) +
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City and Country",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 0, hjust = 0.5),  # Center-align labels
axis.title.x = element_text(size = 12, margin = margin(t = 10)), # Add margin
legend.position = "bottom"                                        # Legend at bottom
)
tab5_boxplot <- tab5_boxplot %>%
mutate(city_country_label = paste0(city, "\n", country))
ggplot(tab5_boxplot, aes(x = city_country_label, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge(width = 0.8) # Side-by-side box plots
) +
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City and Country",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 0, hjust = 0.5),  # Center-align labels
axis.title.x = element_text(size = 12, margin = margin(t = 10)), # Add margin
legend.position = "bottom"                                        # Legend at bottom
)
# CREATE A BOXPLOT
# Create table in correct data format
tab5_boxplot <- tab5_city_data %>%
# Calculate Q1 and Q3
mutate(
q1_org_rice = median_org_rice - (iqr_org_rice / 2),
q3_org_rice = median_org_rice + (iqr_org_rice / 2),
q1_conv_rice = median_conv_rice - (iqr_conv_rice / 2),
q3_conv_rice = median_conv_rice + (iqr_conv_rice / 2),
) %>%
# Select necessary columns
select(
country, city,
min_org_rice, q1_org_rice, median_org_rice, q3_org_rice, max_org_rice,
min_conv_rice, q1_conv_rice, median_conv_rice, q3_conv_rice, max_conv_rice
) %>%
# Reshape into long format
pivot_longer(
cols = c(min_org_rice, q1_org_rice, median_org_rice, q3_org_rice, max_org_rice,
min_conv_rice, q1_conv_rice, median_conv_rice, q3_conv_rice, max_conv_rice), # Include all relevant columns
names_to = c(".value", "Type"),                # Separate names into '.value' (metrics) and 'Type'
names_pattern = "(.*)_(org|conv)"              # Pattern: metric_(org|conv)
)
# Create boxplot
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge2(padding = 0.3) # Dodge to avoid overlapping between cities
) +
facet_wrap(~ country, scales = "free_x") + # Separate panels by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), # Rotated x-axis labels
strip.text = element_text(size = 12, face = "bold"), # Facet titles
legend.position = "bottom", # Move legend to the bottom
legend.title = element_blank() # Remove legend title
)
# Create boxplot
ggplot(tab5_boxplot, aes(x = city, fill = Type)) +
geom_boxplot(
aes(
ymin = min,
lower = q1,
middle = median,
upper = q3,
ymax = max
),
stat = "identity",
position = position_dodge2(padding = 0.3) # Dodge to avoid overlapping between cities
) +
facet_wrap(~ country, scales = "free_x") + # Separate panels by country
labs(
title = "Box Plot of Organic vs Conventional Rice Prices",
x = "City",
y = "Price (per kg, USD)"
) +
scale_fill_manual(
values = c("org" = "skyblue", "conv" = "lightgreen"),
labels = c("Organic", "Conventional")
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1), # Rotated x-axis labels
strip.text = element_text(size = 12, face = "bold"), # Facet titles
legend.position = "bottom", # Move legend to the bottom
legend.title = element_blank() # Remove legend title
)
